<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <style>
        @page {
            size: A4;
            margin: 0;
            @bottom-right {
                content: counter(page);
                font-size: 12px;
                color: #888;
            }
        }

        @font-face {
            font-family: 'NotoSansKR';
            src: url('../fonts/NotoSansKR-Regular.ttf') format('truetype');
        }

        /* í…Œì´ë¸” ë°ì´í„°ê°€ í˜ì´ì§€ë¥¼ ë„˜ì–´ê°€ë„ ìœ íš¨í•˜ë„ë¡ */
        thead {
            display: table-header-group;
        }
        tfoot {
            display: table-footer-group;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 0;
            counter-reset: page;
        }
        /* ì»¤ë²„ ìŠ¤íƒ€ì¼ */
        .cover-page {
            background-color: #2D4E9B;
            color: white;
            padding: 50px;
            height: 297mm;
            box-sizing: border-box;
        }

        .logo {
            width: 150px;
            margin-bottom: 50px;
        }

        .project-title {
            font-size: 32px;
            font-weight: 600;
            margin: 10px 0 30px 0;
            width: fit-content;
            border-bottom: #ffffff 2px solid;
        }

        .meta-info {
            font-size: 14px;
            /*margin-bottom: 4px;*/
        }

        .sub-line {
            height: 2px;
            width: 70%;
            background-color: white;
            margin: 13px 0 15px 0;
        }


        .contents-title {
            color: #FFD600;
            font-size: 25px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .content-container {
            margin-top: 200px;

        }
        .sub-title {
            margin-top: 10px;
            margin-bottom: 10px;
            color: #001560;
            font-weight: bold;
            font-size: 16px;
        }
        .description {
            font-size : 12px;
            margin-bottom: 10px;
        }
        .contents {
            width: 100%;
            text-align: justify;
            justify-content: space-between;
        }

        .content-block {
            display: inline-block;
            width: 23%;
            margin-right: 1%;
            vertical-align: top;
        }

        .content-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .content-title {
            font-size:  16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .content-subtext {
            font-size: 14px;
            color: #e0e0e0;
            line-height: 1.4;
        }
        .fixed-width-table {
            table-layout: fixed;
            width: 100%;
        }

        .page-break {
            page-break-after: always;
        }

        /* ìš”ì•½ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .summary-page {
            background-color: white;
            color: black;
            padding: 20px 50px 50px 50px;
            height: 297mm;
            box-sizing: border-box;
        }

        .section-title {
            font-size: 25px;
            font-weight: bold;
            color: #001560;
            border-bottom: 2px solid #001560;
            padding-bottom: 10px;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 5px;
        }

        .info-table th, .info-table td {
            font-size: 12px;
            border: 1px solid #ccc;
            padding: 4px 5px;
            text-align: left;
        }

        .info-table th {
            background-color: #f2f2f2;
        }

        /* ì‘ì—… ê³µì • í˜ì´ì§€  */
        .process-page {
            background-color: white;
            color: black;
            padding: 20px 50px 50px 50px;
            height: 297mm;
            box-sizing: border-box;
        }
        .process-table td {
            padding: 4px 6px;
            height: auto;
        }
        /* ì»¨í…Œì´ë„ˆë¥¼ flexë¡œ ë‚˜ë€íˆ */
        .stats-cards {
            white-space: nowrap;  /* ì¤„ë°”ê¿ˆ ê¸ˆì§€ */
            width: 100%;
        }
        /* í…Œì´ë¸”, TH, TD ì˜ border ëª¨ë‘ ì—†ì• ê¸° */
        .info-table.no-border,
        .info-table.no-border th,
        .info-table.no-border td {
            border: none !important;
        }
        .info-table.no-border {
            border-collapse: separate;      /* ë°˜ë“œì‹œ separate ì—¬ì•¼ spacing ì´ ë¨¹ìŠµë‹ˆë‹¤ */
            border-spacing: 10px 0;       /* ê°€ë¡œ ê°„ê²© 0px, ì„¸ë¡œ ê°„ê²© 10px */
        }
        /* no-border í…Œì´ë¸”ì˜í—¤ë” ë°°ê²½ìƒ‰ ì œê±° */
        .info-table.no-border th {
            padding: 10px 10px 0 10px;
            /*background-color: transparent !important;*/
            background-color: #F8F9FA !important;
        }
        .info-table.no-border td {
            /*background-color: transparent !important;*/
            background-color: #F8F9FA !important;
            /*padding: 10px;*/
            padding-right: 10px;
            padding-bottom: 10px;
        }

        /* ì•„ì´ì½˜ê³¼ ë¼ë²¨, ê°’ ìŠ¤íƒ€ì¼ë§ */
        .stat-icon {
            display: inline-block;
            font-size: 12px;
            margin-bottom: 4px;
            margin-right: 5px;
            /*color: #56D193;*/
            text-align: left;
        }


        /*  ì§€ì—° ë¶„ì„ í˜ì´ì§€   */
        .delay-page {
            background-color: white;
            color: black;
            padding: 20px 50px 50px 50px;
            height: 297mm;
            box-sizing: border-box;
        }
        .chart-section {
            width: 100%;
            display:flex;
            flex-direction:row;
            justify-content: space-between;
            gap: 10px;
        }
        .chart-box {
            height  : 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .left-box {
            float: left;
            margin-right: 10px;
            width: 45%;
        }

        .right-box {
            float: right;
            width: 45%;
        }
        /*.chart-box {*/
        /*    width: 50%;*/
        /*}*/
        img {
            display: block;
            margin-top: 15px;
            margin-bottom: 25px;
        }

    </style>
</head>
<body>

<!-- ğŸŸ¦ Cover Page (1í˜ì´ì§€) -->
<div class="cover-page">
    <div class="logo-header">
        <img th:src="'data:image/png;base64,' + ${coverLogo}" class="logo" alt="Core Flow Logo" />
    </div>

    <p class="project-title" th:text="${projectName}"></p>

    <p class="meta-info" style="font-weight: bold">ì‘ì„±ì¼ì&nbsp;&nbsp;&nbsp;
        <span th:text="${reportCreatedAt}" style="font-weight: normal"></span>
    </p>
    <p class="meta-info" style="font-weight: bold">ì´ê´„ ì±…ì„ì&nbsp;&nbsp;&nbsp;
        <span th:text="${director}" style="font-weight: normal"> </span>
    </p>


    <div class="content-container">
        <p class="contents-title">Contents :</p>
        <div class="contents">
            <div class="content-block">
                <p class="content-number">01</p>
                <div class="sub-line"></div>
                <p class="content-title">í”„ë¡œì íŠ¸ ê°œìš”</p>
                <p class="content-subtext">í”„ë¡œì íŠ¸ëª…<br />ìˆ˜í–‰ ê¸°ê°„<br />ê´€ë¦¬ì</p>
            </div>
            <div class="content-block">
                <p class="content-number">02</p>
                <div class="sub-line"></div>
                <p class="content-title">ì‘ì—… ê³µì •</p>
                <p class="content-subtext">ì „ì²´ ì¼ì • ìš”ì•½<br />ê³µì •ë³„ ì§„í–‰ë¥  ë° ì¼ì •<br />ì£¼ìš” ë§ˆì¼ìŠ¤í†¤ ë¦¬ìŠ¤íŠ¸</p>
            </div>
            <div class="content-block">
                <p class="content-number">03</p>
                <div class="sub-line"></div>
                <p class="content-title">ì§€ì—° ë¶„ì„</p>
                <p class="content-subtext">ì „ì²´ ì§€ì—° ê¸°ê°„ ë¶„ì„<br />ì§€ì—° ì›ì¸ ë¶„ì„<br />ì§€ì—° ì‚¬ìœ ì„œ ëª©ë¡</p>
            </div>
            <div class="content-block">
                <p class="content-number">04</p>
                <div class="sub-line"></div>
                <p class="content-title">ì„±ê³¼ í‰ê°€</p>
                <p class="content-subtext">ì „ì²´ ë‚©ê¸° ì¤€ìˆ˜ìœ¨<br />í‰ê·  ì§€ì—°ì¼ / ì„±ê³¼ ë¹„êµ<br />ì£¼ìš” ì‚°ì¶œë¬¼ ëª©ë¡<br />í–¥í›„ ê°œì„  ì‚¬í•­</p>
            </div>
        </div>
    </div>
</div>

<div class="page-break"></div>

<!-- â¬œ 01 ì±•í„° - í”„ë¡œì íŠ¸ ìš”ì•½ í˜ì´ì§€ (1) -->
<div class="summary-page">
    <div class="logo-header">
        <img th:src="'data:image/png;base64,' + ${contentLogo}"
             alt="Core Flow Logo"
             style="height: 40px; width: auto;" />
    </div>

    <p class="section-title">01 í”„ë¡œì íŠ¸ ê°œìš”</p>

    <div class="sub-title" style="margin-top: 30px;">
        í”„ë¡œì íŠ¸ ìš”ì•½
    </div>
    <table class="info-table">
        <tr>
            <th>í”„ë¡œì íŠ¸ëª…</th>
            <td th:text="${projectName}"><strong>26FW í•œí™” ì´ê¸€ìŠ¤ ì½œë¼ë³´ í”„ë¡œì íŠ¸</strong></td>
        </tr>
        <tr>
            <th>ì„¤ëª…</th>
            <td th:text="${projectDescription}">2025ë…„ S/S ì‹œì¦Œ ì‹ ì œí’ˆìœ¼ë¡œ ê¸°íšëœ íŒ¨ì…˜ ìì¼“ì˜ ê°œë°œ í”„ë¡œì íŠ¸</td>
        </tr>
        <tr>
            <th>ì´ê´„ ê´€ë¦¬ì</th>
            <td th:text="${director}">í™ê¸¸ë™ ê¸°íšíŒ€ íŒ€ì¥</td>
        </tr>
        <tr>
            <th>ì§„í–‰ ê¸°ê°„</th>
            <td th:text="${projectPeriodData}">2025-03-01 ~ 2025-03-31 (ì´ 31ì¼)</td>
        </tr>
        <tr>
            <th>ì‘ì„± ì¼ì</th>
            <td th:text="${reportCreatedAt}">2025-04-01</td>
        </tr>
        <tr>
            <th>ì§€ì—°ì¼</th>
            <td th:text="${projectDelayDays}+ 'ì¼'">1ì¼</td>
        </tr>
    </table>

    <!-- ì°¸ì—¬ì ëª©ë¡ -->
    <div class="sub-title" style="margin-top: 30px;">
        ë¶€ì„œë³„ ì°¸ì—¬ì
    </div>
    <table class="info-table" style="padding: 10px;">
        <tr th:each="entry : ${participantList}">
            <td style="padding-left : 20px; width: 150px; background-color: #f2f2f2;">
                <strong th:text="${entry.key}"></strong>
            </td>
            <td style="padding-left : 20px;">
                <div th:each="person : ${entry.value}" th:text="${person}">ì°¸ì—¬ì ì´ë¦„</div>
            </td>
        </tr>
    </table>
</div>

<div class="page-break"></div>

<!-- â¬œ 02 ì±•í„° - ì‘ì—… ê³µì • í˜ì´ì§€ (2 ~) -->
<div th:each="page, stat : ${pagedTaskList}">
    <div class="process-page">
        <!-- ë¡œê³  + ì œëª© -->
        <div class="logo-header">
            <img th:src="'data:image/png;base64,' + ${contentLogo}"
                 alt="Core Flow Logo"
                 style="height: 40px; width: auto;" />
        </div>

        <p class="section-title"
           th:text="${stat.index == 0 ? '02 ì‘ì—… ê³µì •' : ''}"></p>

        <div class="sub-title">ì‘ì—… ê³µì • ë‚´ì—­
            <span th:text="${stat.index + 1}"></span>
        </div>
        <div class="description">
            í”„ë¡œì íŠ¸ ê¸°ê°„ë™ì•ˆ ì´ <span th:text="${taskList.size()}" /> ê°œì˜ íƒœìŠ¤í¬ë¥¼ ì§„í–‰í•˜ì…¨ìŠµë‹ˆë‹¤.
        </div>


        <table class="info-table process-table">
            <thead>
            <tr>
                <th style="width: 15px; padding: 3px"></th>
                <th>ì—…ë¬´</th>
                <th>ë² ì´ìŠ¤ë¼ì¸</th>
                <th>ì‹¤ì œ ì‘ì—… ê¸°ê°„</th>
                <th>ê³„íš ëŒ€ë¹„</th>
                <th>ìƒíƒœ</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="task , idx: ${page}">
                <td th:text="${idx.index + 1 + (stat.index * 15)}"></td>
                <td th:text="${task.getTaskName()}">íŒ¨í„´ ìƒì„±</td>
                <td th:text="${task.getStartBase()} + ' ~ ' + ${task.getEndBase()}">2025-03-05 ~ 2025-03-08</td>
                <td th:text="${task.getStartReal()} + ' ~ ' + ${task.getEndReal()}">2025-03-05 ~ 2025-03-09</td>
                <td th:text="'+ ' + ${task.getDelayDays()} + 'ì¼'"
                    th:style="${task.getDelayDays > 0} ? 'color: red;' : ''">+1ì¼</td>
                <td th:text="${task.getStatus()}"
                    th:style="${task.getStatus()} == 'COMPLETED' ? 'color:#34C759;' : ''">
                </td>
            </tr>
            </tbody>
        </table>

        <!-- ì´ê³„ ì •ë³´: ë§ˆì§€ë§‰ í˜ì´ì§€ì—ë§Œ í‘œì‹œ -->
        <div class="sub-title" th:if="${stat.last}" style="margin-top: 20px;">
            ì‘ì—… ê³µì • ê²°ê³¼
        </div>
<!--        fixed-width-table"-->
        <table class="process-result info-table"  th:if="${stat.last}">
            <thead>
                <tr>
                    <th>ì „ì²´ íƒœìŠ¤í¬</th>
                    <th>ë² ì´ìŠ¤ë¼ì¸</th>
                    <th>ì‹¤ì œ ì‘ì—… ê¸°ê°„</th>
                    <th>ì´ ì†Œìš”ì¼</th>
                    <th>ê³„íš ëŒ€ë¹„</th>
                    <th>ìƒíƒœ</th>
                </tr>
            </thead>
            <tbody>
                <tr style="text-align: center;">
                    <!-- 1) íƒœìŠ¤í¬ ê°œìˆ˜ + "ê°œ" -->
                    <td style="font-weight: bold;  text-align:right; font-size:13px; padding-right: 15px;">
                        <span th:text="${taskList.size()} + 'ê°œ'">8ê°œ</span>
                    </td>

                    <!-- 2) baseStart ~ baseEnd -->
                    <td style="text-align: right;font-size:10px;">
                        <span th:text="${total.baseStart}"></span> ~ <span th:text="${total.baseEnd}"></span>
                    </td>
                    <!-- 3) realStart ~ realEnd -->
                    <td style="text-align: right;font-size:10px;">
                        <span th:text="${total.realStart}"></span> ~ <span th:text="${total.realEnd}"></span>
                    </td>
                    <td th:text="${total.realDuration} + ' ì¼'"
                        style="font-weight: bold;  text-align:right; font-size:13px; padding-right: 15px;">
                        29ì¼
                    </td>

                    <!-- 4) delay: 0ë³´ë‹¤ í¬ë©´ +Nì¼, ì•„ë‹ˆë©´ 0ì¼ + ìƒ‰ìƒ ì¡°ê±´ -->
                    <td
                            th:style="${total.delay > 0} ? 'color: red;' : ''"
                            style="font-weight: bold; text-align:right; font-size:13px; padding-right: 15px;">
                        +10ì¼
                    </td>

                    <!-- 5) ìƒíƒœ: 'ì§€ì—°'ì¼ ë•Œ ë¹¨ê°• -->
                    <td
                            th:text="${total.status}"
                            th:style="'font-weight: bold; text-align:right; font-size:13px; padding-right: 15px;' + (total.status == 'ì§€ì—°' ? ' color: red;' : '')"
                    >
                        ì§€ì—°
                    </td>
                </tr>
            </tbody>

        </table>
        <div class="page-break"></div>
    </div>
</div>
<div class="page-break"></div>


<!-- â¬œ 03 ì±•í„° - ì§€ì—° ë¶„ì„ í˜ì´ì§€ (ë‹¤ì¤‘ í˜ì´ì§€ ì§€ì›) -->
<div th:each="delayPage, stat : ${pagedDelayReportList}">
    <!-- 1) ì§€ì—° ë¶„ì„ ì°¨íŠ¸ í˜ì´ì§€ë§Œ ë‹´ëŠ” í˜ì´ì§€ -->
    <div class="delay-page">
        <div class="logo-header">
            <img th:src="'data:image/png;base64,' + ${contentLogo}"
                 alt="Core Flow Logo" style="height:40px; width:auto;" />
        </div>
        <p class="section-title" th:text="${stat.index == 0 ? '03 ì§€ì—° ë¶„ì„' : ''}"></p>

        <div class="chart-box left-box">
            <p class="sub-title">ì§€ì—° íƒœìŠ¤í¬ ë¶„ì„</p>
            <div class="description">
                ì „ì²´ <span th:text="${taskList.size()}"/>ê°œì˜ íƒœìŠ¤í¬ ì¤‘
                <span th:text="${delayedTaskList.size()}"/>ê°œì—ì„œ ì§€ì—° ë°œìƒ
            </div>
            <img th:src="'data:image/png;base64,' + ${delayTaskChart}" width="100%" />
        </div>
        <div class="chart-box right-box">
            <p class="sub-title">ì§€ì—° ì‚¬ìœ  ë¶„ì„</p>

            <div class="description" th:if="${delayReasonSummary}">
                <span th:text="${delayReasonSummary}"></span>
            </div>

            <img th:src="'data:image/png;base64,' + ${delayReasonChart}" width="100%" />
        </div>

        <!-- ì±•í„° 3 - ë¶€ì„œë³„ ì§€ì—° ê·¸ë˜í”„ -->
        <div style="margin-top: 350px; width: 100%;">
            <p class="sub-title">ë¶€ì„œë³„ ì§€ì—° ë¶„ì„</p>
            <img th:src="'data:image/png;base64,' + ${deptDelayChart}" width="75%" />
            <div class="description" th:if="${delayDeptSummary}">
                <span th:text="${delayDeptSummary}"></span>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ ë¶„ë¦¬ -->
    <div class="page-break"></div>

    <!-- 2) ì§€ì—° ì‚¬ìœ ì„œ ë‚´ì—­ë§Œ ë‹´ëŠ” ìƒˆ í˜ì´ì§€ -->
    <div class="delay-page">
        <div class="logo-header">
            <img th:src="'data:image/png;base64,' + ${contentLogo}"
                 alt="Core Flow Logo" style="height:40px; width:auto;" />
        </div>
        <!-- (íƒ€ì´í‹€ ë°˜ë³µì´ í•„ìš” ì—†ìœ¼ë©´ ì§€ìš°ì…”ë„ ë©ë‹ˆë‹¤) -->
        <p class="section-title">03 ì§€ì—° ë¶„ì„</p>
        <!-- â—¼ íŒ€ë³„ ì§€ì—° ë¹„êµ í…Œì´ë¸” -->
        <div class="sub-title" style="margin-top: 30px;">ë¶€ì„œë³„ ì§€ì—° ë¹„êµ</div>
        <table class="info-table">
            <thead>
            <tr>
                <th>íŒ€ ì´ë¦„</th>
                <th>í‰ê·  ì§€ì—°ì¼</th>
                <th>ì´ ì§€ì—°ì¼</th>
                <th>ì „ì²´ ëŒ€ë¹„(%)</th>
            </tr>
            </thead>
            <tbody>
            <!-- deptDelayStats: List<Map<String,Object>> -->
            <tr th:each="stat : ${deptDelayStats}">
                <td th:text="${stat.deptName}">ë””ìì¸íŒ€</td>
                <td th:text="${stat.avgDelay} + ' ì¼'">2.4 ì¼</td>
                <td th:text="${stat.totalDelay} + ' ì¼'">10 ì¼</td>
                <td th:text="${stat.percentOfTotal} + '%'">38%</td>
            </tr>
            </tbody>
        </table>

        <div class="sub-title" style="margin-top:30px;">
            ì§€ì—° ì‚¬ìœ ì„œ ë‚´ì—­ - <span th:text="${stat.index + 1}"></span>
        </div>
        <table class="info-table">
            <thead>
            <tr>
                <th>ì—…ë¬´ êµ¬ë¶„(íƒœìŠ¤í¬ëª…)</th>
                <th>ìƒì„±ì¼</th>
                <th>ê²°ì¬ì</th>
                <th>íŒŒì¼ ë§í¬</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.isEmpty(delayPage)}">
                <td colspan="4" style="text-align:center;">ì§€ì—° ì‚¬ìœ ì„œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            <tr th:each="delay : ${delayPage}">
                <td th:text="${delay.taskName}"></td>
                <td th:text="${#temporals.format(delay.createdDate,'yyyy-MM-dd')}"></td>
                <td th:text="${delay.approverName + ' ' + delay.approverJobRank}"></td>
                <td><a th:href="${delay.url}">LINK</a></td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- ë‹¤ìŒ ì±•í„° ì „ í˜ì´ì§€ ë¶„ë¦¬ -->
    <div class="page-break"></div>
</div>


<div class="page-break"></div>


<!-- â¬œ 04 ì±•í„° - ì„±ê³¼ í‰ê°€ í˜ì´ì§€  -->
<!--ë°ì´í„° ìˆëŠ” ê²½ìš°-->
<div class="delay-page">
    <div class="logo-header">
        <img th:src="'data:image/png;base64,' + ${contentLogo}"
             alt="Core Flow Logo"
             style="height: 40px; width: auto;" />
    </div>
        <p class="section-title">04 ì„±ê³¼ í‰ê°€</p>

        <!-- í‰ê°€ ìš”ì•½ ì •ë³´ëŠ” ì²« í˜ì´ì§€ì—ë§Œ -->
        <div>
            <div class="sub-title">ì„±ê³¼ í‰ê°€</div>

            <table class="info-table" >
                <tr >
                    <th style="width: 115px; font-size: 11px;">
                        <span class="stat-icon" style="color: #4D91FF;">â– </span>
                        ì „ì²´ ë‚©ê¸° ì¤€ìˆ˜ìœ¨</th>
                    <th style="width: 115px;font-size: 11px;">
                        <span class="stat-icon" style="color: gray;">â– </span>
                        ì „ì²´ íƒœìŠ¤í¬</th>
                    <th style="width: 115px; font-size: 11px;">
                        <span class="stat-icon" style="color: #56D193;">â– 
                        </span>ê¸°í•œ ë‚´ ì™„ë£Œ</th>
                    <th style="width: 115px; font-size: 11px;">
                        <span class="stat-icon" style="color:lightslategray;">â– </span>
                        ê¸°í•œ ë‚´ ë¯¸ì™„ë£Œ</th>
                    <th style="width: 115px; font-size: 11px;">
                        <span class="stat-icon" style="color: #FF914D;">â– </span>
                        í‰ê·  ì§€ì—°ì¼</th>
                    <th style="width: 115px; font-size: 11px;">
                        <span class="stat-icon" style="color: #FF914D;">â– </span>
                        ì´ ì§€ì—°ì¼</th>
                </tr>
                <tr>
                    <td style="color: #0A84FF; font-weight: bold; text-align:right; font-size:15px; padding-right: 15px;"
                        th:text="${OTD} + ' %'">
                        90%</td>
                    <td th:text="${totalTask} + ' ê°œ'"
                        style="font-weight: bold; text-align:right; font-size:15px; padding-right: 15px;">
                        10ê°œ
                    </td>
                    <td th:text="${completedOnTime} + ' ê°œ'"
                        style="font-weight: bold; text-align:right; font-size:15px; padding-right: 15px;">
                        10ê°œ
                    </td>
                    <td style="font-weight: bold; text-align:right; font-size:15px; padding-right: 15px;"
                        th:text="${notCompletedOnTime} + ' ê°œ'">
                        10ê°œ
                    </td>
                    <td
                            th:text="'+ ' +${meanDelay} + ' ì¼'"
                            th:style="${meanDelay > 0}
                            ? 'color: red; font-weight: bold; text-align: right; font-size: 15px; padding-right: 15px;'
                            : 'color: #222; text-align: right; font-size: 15px; padding-right: 15px;'">10ì¼
                    </td>
                    <td
                            th:text="'+ ' + ${totalDelay} + ' ì¼'"
                            th:style="${totalDelay > 0}
                            ? 'color: red; font-weight: bold; text-align: right; font-size: 15px;'
                            : 'color: #222; text-align: right; font-size: 15px;'"> 10ì¼
                    </td>
                </tr>
            </table>
        </div>
        <div class="sub-title" style="margin-top: 20px;">ì£¼ìš” ë³‘ëª© ê³µì •</div>
            <div style="font-size: 12px; background-color: #F8F9FA; padding: 10px">
                    <span th:each="task, idx : ${delayedTaskList}">
                        <span th:text="${task.getTaskName()}">exex</span>
                        <span th:if="${!idx.last}">, </span>
                    </span>
            </div>



        <div class="sub-title" style="margin-top: 20px;">í”„ë¡œì íŠ¸ ë‚©ê¸° ì¤€ìˆ˜ìœ¨ ë¹„êµ</div>
        <div style="font-weight: 300; font-size: 10px; margin-bottom: 12px;"
             th:text="'ìµœê·¼ 6ê°œì›” ê°„ ì™„ë£Œëœ í”„ë¡œì íŠ¸ ' + ${projectCount} + 'ê±´ ëŒ€ìƒ ë‚©ê¸° ì¤€ìˆ˜ìœ¨ ë¹„êµ'">
        </div>
        <img th:if="${compareOtdChart}" th:src="'data:image/png;base64,' + ${compareOtdChart}" style="width: 80%; max-width: 600px;" />

        <!--  í‰ê°€  -->
        <p th:style="|
            font-size: 12px;
            padding: 10px;
            background-color: ${
                evalType == 'EXCELLENT' ? '#E6F4EA' :
                (evalType == 'NEEDS_IMPROVEMENT' ? '#FFF0F0' :
                '#F0F7FF')
            };
        |">
            ğŸ“Š <span th:text="${otdComparisonComment}">OTD í‰ê°€ ë¬¸êµ¬ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</span>
        </p>


    <div class="page-break"></div>
</div>


<div class="page-break"></div>

<!-- ì‚°ì¶œë¬¼ ëª©ë¡ í˜ì´ì§€ -->
<!-- ì‚°ì¶œë¬¼ ë‚´ì—­ì´ ì—†ëŠ” ê²½ìš° -->
<div th:if="${pagedOutputList == null or #lists.isEmpty(pagedOutputList)}">
    <div class="delay-page">
        <div class="logo-header">
            <img th:src="'data:image/png;base64,' + ${contentLogo}"
                 alt="Core Flow Logo"
                 style="height: 40px; width: auto;" />
        </div>

        <p class="section-title">04 ì„±ê³¼ í‰ê°€</p>
        <div class="sub-title" style="margin-top: 20px;">ì§€ì—° ë¶„ì„ ìš”ì•½</div>
        <!--  ì§€ì—° ë¶„ì„-->
        <div style="padding: 10px; background-color: #f0faff;">
            <p  th:utext="${delayAnalysisText}"
                style="font-size: 11px;"
            ></p>
        </div>


        <div class="sub-title" style="margin-top: 20px;">í”„ë¡œì íŠ¸ ì „ì²´ í‰ê°€ ìš”ì•½</div>
        <div style="padding: 10px; background-color: #f0faff;">
        <p th:utext="${overallSummary}" class="description"></p>
        </div>


        <div class="sub-title" style="margin-top: 20px;">ì‚°ì¶œë¬¼ ëª©ë¡</div>
        <p style="font-size: 10px;">ì‚°ì¶œë¬¼ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    </div>
    <div class="page-break"></div>
</div>
<div th:each="outputPage, stat : ${pagedOutputList}">
    <div class="delay-page">
        <div class="logo-header">
            <img th:src="'data:image/png;base64,' + ${contentLogo}"
                 alt="Core Flow Logo"
                 style="height: 40px; width: auto;" />
        </div>

        <p class="section-title">04 ì„±ê³¼ í‰ê°€</p>
        <div class="sub-title" style="margin-top: 20px;">ì „ì²´ í‰ê°€ ìš”ì•½</div>
        <!--  ì§€ì—° ë¶„ì„-->
        <p  th:utext="${delayAnalysisText}"
            style="font-size: 11px;"
        ></p>

        <div class="page-break"></div>

        <div class="sub-title" style="margin-top: 20px;">ì‚°ì¶œë¬¼ ëª©ë¡</div>
        <table class="info-table">
            <thead>
            <tr>
                <th></th>
                <th>ê´€ë ¨ íƒœìŠ¤í¬</th>
                <th>ì‚°ì¶œë¬¼ ëª…</th>
                <th>ë“±ë¡ì</th>
                <th>ë“±ë¡ì¼</th>
                <th>ë¯¸ë¦¬ë³´ê¸°</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.isEmpty(outputPage)}">
                <td colspan="6" style="text-align: center;">ì‚°ì¶œë¬¼ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            <tr th:each="item , idx: ${outputPage}">
                <td th:text="${idx.index + 1 + (stat.index * 15)}" style="width: fit-content;"></td>
                <td th:text="${item.taskName}">íƒœìŠ¤í¬ ë¶„ë¥˜</td>
                <td th:text="${item.originName}">ì œí’ˆê¸°íšì„œ.pdf</td>
                <td th:text="${item.uploader}">ê¸°íšíŒ€ ê¹€í•˜ëŠ˜</td>
                <td th:text="${item.uploadAt}">2025-05-01</td>
                <td><a th:href="${item.url}">LINK</a></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="page-break"></div>
</div>

</body>
</html>
